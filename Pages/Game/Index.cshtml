@* -------------------- *@
@* Game Index html file *@
@* -------------------- *@
@page
@model Wyrmquest.Pages.Game.IndexModel
@{
    Layout = "_GameLayout";
}
<div class="top-bar">
    Health: @Model.PlayerHealth | XP: @Model.PlayerXP | Gold: @Model.PlayerGold
</div>

<div class="container">
    <div class="sidebar">
        <h3>Menu</h3>
        <ul>
            <li><button onclick="togglePanel('statsPanel')">View Stats</button></li>
            <li><button onclick="togglePanel('inventoryPanel')">Inventory</button></li>
            <li><button onclick="togglePanel('settingsPanel')">Settings</button></li>
        </ul>

        <div id="statsPanel" class="panel hidden">
            <h3>Stats</h3>
            <ul>
                <li>Strength: 1</li>
                <li>Dexterity: 1</li>
                <li>Agility: 1</li>
                <li>Evasion: 1</li>
                <li>Intelligence: 1</li>
                <li>Wisdom: 1</li>
                <li>Luck: 1</li>
                <li>Health: 100</li>
                <li>Mana: 50</li>
            </ul>
        </div>

        <div id="inventoryPanel" class="panel hidden">
            <h3>Inventory</h3>
            <p>(Inventory items go here)</p>
        </div>

        <div id="settingsPanel" class="panel hidden">
            <h3>Settings</h3>
            <p>(Settings options go here)</p>
        </div>
    </div>

    <div class="main">
        <h2>Wyrmquest</h2>

        <p>Current Position: @Model.Position.MapId (@Model.Position.X, @Model.Position.Y)</p>

        <div class="location-section">
            <h2 class="location-title">@Model.CurrentMapId</h2>

            @* @if (Model.InCombat)
            {
                <div class="combat-display">
                    <div class="combat-log">
                        @foreach (var line in Model.CombatMessages)
                        {
                            <p>@line</p>
                        }
                    </div>
                    <div class="combat-image">
                        <img src="@Model.CurrentTile.EnemyImage" alt="Enemy" />
                    </div>
                </div>
            } *@

            <div class="location-image-wrapper">
                @if (Model.SpawnedEnemy != null)
                {
                    <img src="/images/enemy/@Model.SpawnedEnemy.ImageName" class="location-image" alt="@Model.SpawnedEnemy.Name" />
                }
                else if (!string.IsNullOrEmpty(Model.CurrentTile?.LocationImage))
                {
                    <img src="@Model.CurrentTile.GetLocationImagePath()" class="location-image" alt="Location" />
                }
                else
                {
                    <div class="location-image-placeholder"></div>
                }
            </div>

            @if (Model.SpawnedEnemy != null)
            {
                <div class="enemy-info">
                    <h3 class="enemy-name">@Model.SpawnedEnemy.Name</h3>
                    <p class="enemy-description">@Model.SpawnedEnemy.Description</p>
                </div>
            }



            <div class="location-description">
                @if (Model.CurrentTile?.Description !=null)
                {
                <p>@Model.CurrentTile?.Description</p>
                }
            </div>

            @if (Model.CurrentTile?.Items?.Any() == true)
            {
                <div class="item-pickups">
                    <strong>Items:</strong>
                    <ul>
                        @foreach (var item in Model.CurrentTile.Items)
                        {
                            <li><a href="@Url.Action("PickUpItem", new { id = item.Id })">@item.Name</a></li>
                        }
                    </ul>
                </div>
            }

            <div class="movement-section">
                <div class="compass-grid">
                    @foreach (var dir in Model.CompassDirections)
                    {
                        <form method="post">
                            <input type="hidden" name="direction" value="@dir.Direction" />
                            <button @(dir.IsAvailable ? "" : "disabled")>@dir.Label</button>
                        </form>
                    }
                </div>

                <div class="extra-options">
                    @foreach (var option in Model.SpecialActions)
                    {
                        <form method="post">
                            <input type="hidden" name="direction" value="@option.Action" />
                            <button>@option.Label</button>
                        </form>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="right-panel">
    </div>

    <div class="chat">
        <strong>Chat Log:</strong><br />
        @Html.Raw(Model.ChatLog)
    </div>
</div>