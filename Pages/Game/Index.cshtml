@page
@model Wyrmquest.Pages.Game.IndexModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Wyrmquest</title>
    <style>
        body {
            margin: 0;
            font-family: 'Courier New', monospace;
            background-color: #1e1e1e;
            color: #ddd;
        }

        .top-bar {
            background-color: #2c2c2c;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            border-bottom: 1px solid #444;
        }

        .container {
            display: grid;
            grid-template-columns: 200px 1fr 200px;
            grid-template-rows: 1fr 120px;
            height: calc(100vh - 40px);
        }

        .sidebar, .right-panel {
            background-color: #2a2a2a;
            padding: 10px;
            border-right: 1px solid #444;
        }

        .right-panel {
            border-left: 1px solid #444;
        }

        .main {
            padding: 10px;
            overflow-y: auto;
        }

        .chat {
            grid-column: 1 / span 3;
            background-color: #1a1a1a;
            padding: 10px;
            overflow-y: auto;
            font-size: 0.9em;
            border-top: 1px solid #444;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        li {
            margin-bottom: 8px;
        }

        a {
            color: #8ecfff;
            text-decoration: none;
        }

            a:hover {
                text-decoration: underline;
            }

        .panel {
            margin-top: 10px;
        }

        .compass-wrapper {
            margin-top: 20px;
            text-align: center;
        }

        .compass-grid {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
            justify-content: center;
            margin-bottom: 10px;
        }

            .compass-grid button {
                width: 100%;
                height: 100%;
                background-color: #333;
                color: #ddd;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }

                .compass-grid button:disabled {
                    background-color: #222;
                    color: #666;
                    cursor: not-allowed;
                }

        .extra-options form {
            margin-bottom: 5px;
        }

        .extra-options button {
            padding: 6px 12px;
            background-color: #444;
            color: #ddd;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

            .extra-options button:hover {
                background-color: #555;
            }
    </style>
</head>
<body>
    <div class="top-bar">
        Health: @Model.PlayerHealth | XP: @Model.PlayerXP | Gold: @Model.PlayerGold
    </div>

    <div class="container">
        <div class="sidebar">
            <h3>Menu</h3>
            <ul>
                <li><button onclick="togglePanel('statsPanel')">View Stats</button></li>
                <li><button onclick="togglePanel('inventoryPanel')">Inventory</button></li>
                <li><button onclick="togglePanel('settingsPanel')">Settings</button></li>
            </ul>

            <div id="statsPanel" class="panel" style="display:none;">
                <h3>Stats</h3>
                <ul>
                    <li>Strength: 1</li>
                    <li>Dexterity: 1</li>
                    <li>Agility: 1</li>
                    <li>Evasion: 1</li>
                    <li>Intelligence: 1</li>
                    <li>Wisdom: 1</li>
                    <li>Luck: 1</li>
                    <li>Health: 100</li>
                    <li>Mana: 50</li>
                </ul>
            </div>

            <div id="inventoryPanel" class="panel" style="display:none;">
                <h3>Inventory</h3>
                <p>(Inventory items go here)</p>
            </div>

            <div id="settingsPanel" class="panel" style="display:none;">
                <h3>Settings</h3>
                <p>(Settings options go here)</p>
            </div>
        </div>

        <div class="main">
            <h2>Wyrmquest</h2>
            <p>@Model.GameMessage</p>

            <p>Current Position: @Model.Position.MapId (@Model.Position.X, @Model.Position.Y)</p>

            <div class="compass-wrapper">
                <div class="extra-options">
                    @foreach (var option in Model.SpecialActions)
                    {
                        <form method="post">
                            <input type="hidden" name="direction" value="@option.Action" />
                            <button>@option.Label</button>
                        </form>
                    }
                </div>

                <div class="compass-grid">
                    @foreach (var dir in Model.CompassDirections)
                    {
                        <form method="post">
                            <input type="hidden" name="direction" value="@dir.Direction" />
                            <button @(dir.IsAvailable ? "" : "disabled")>@dir.Label</button>
                        </form>
                    }
                </div>
            </div>
        </div>

        <div class="right-panel">
            <!-- Reserved for future use -->
        </div>

        <div class="chat">
            <strong>Chat Log:</strong><br />
            @Html.Raw(Model.ChatLog)
        </div>
    </div>

    @if (Model.CurrentTile != null && !string.IsNullOrEmpty(Model.CurrentTile.LocationImage))
    {
        <img src="@Model.CurrentTile.LocationImage" alt="Location image" />
    }


    @if (Model.CurrentTile != null && !string.IsNullOrEmpty(Model.CurrentTile.EnemyImage))
    {
        <img src="@Model.CurrentTile.EnemyImage" alt="Enemy" />
    }


    <script>
        function togglePanel(panelId) {
            const panels = ['statsPanel', 'inventoryPanel', 'settingsPanel'];
            panels.forEach(id => {
                const panel = document.getElementById(id);
                panel.style.display = (id === panelId && panel.style.display !== 'block') ? 'block' : 'none';
            });
        }

    </script>
</body>
</html>
